<canvas id="canvas" style="boarder:1px solid #000000" cursor="none">
	Your browser does not support canvas element
</canvas>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.2.6/jquery.js"></script>
<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
<script src="client/Emitter.js"></script>
<script src="client/gameWindow.js"></script>
<script src="client/point.js"></script>
<script src="client/game.js"></script>
<script>
	console.log('index.html: init')

	document.body.style.backgroundColor = 'black'

	var msg
	var emit

	gameWindow.socket.on('destroy', function() {
		console.log('Server in Limbo')
		gameWindow.socket.destroy()
	})

	gameWindow.socket.on('handShake', function(id, status) {
		gameWindow.socket.id = id

		console.log(`id: ${id}`)

		mg.action('status', {
			token: 'all',
			status: status
		})

		gameWindow.socket.on('status', function(status) {
			mg.action('status', status)
		})

		gameWindow.socket.on('msg', function(msg) {
			console.log(msg)
		})

		gameWindow.socket.on('clear', function() {
			console.log('server: clear level!')
			mg.action('clear')
		})

		gameWindow.socket.on('kill', function(msg) {
			gameWindow.socket.emit('msg', 'Signing off!')
			gameWindow.events.active = false
			console.log('Signing off...')
			gameWindow.socket.destroy()
		})

		mg.status = function(cell) {
			gameWindow.socket.emit('status', mg.observe('status', {
				token: 'cell',
				cell: cell
			}))
		}

		var init = function(gameWindow) {
			mg.setStates(gameWindow.display.g)
		}

		var tick = function(gameWindow) {
			mg.action('shift', gameWindow)
			mg.observe('draw', gameWindow)
		}

		msg = function(msg) {
			gameWindow.socket.emit('msg', msg)
		}
		emit = gameWindow.socket.emit

		gameWindow.tick(gameWindow, init, tick)
	})
</script>
